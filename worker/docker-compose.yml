version: '3.9'

services:
  tee-worker:
    image: tee-randomness-worker:latest
    build: .
    container_name: tee-worker
    ports:
      - '3000:3000'
    environment:
      - PORT=3000
      - NODE_ENV=production
    # Mount SGX device if available (for local testing with SGX hardware)
    # On Phala Cloud, this is handled by the platform
    devices:
      - /dev/sgx_enclave:/dev/sgx_enclave
      - /dev/sgx_provision:/dev/sgx_provision
    volumes:
      # Some TEE environments map attestation here
      - /dev/attestation:/dev/attestation
